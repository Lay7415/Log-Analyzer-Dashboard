# –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –ø–∞–Ω–µ–ª—å –¥–ª—è –ª–æ–≥–æ–≤ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é end-to-end —Å–∏—Å—Ç–µ–º—É –¥–ª—è —Å–±–æ—Ä–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∏, –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–æ–≤ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ Nginx –≤ —Ä–µ–∂–∏–º–µ, –±–ª–∏–∑–∫–æ–º –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏, –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ Ad-hoc –∑–∞–ø—Ä–æ—Å–æ–≤, –∞ —Ç–∞–∫–∂–µ –≤—ã—è–≤–ª—è—Ç—å –∞–Ω–æ–º–∞–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫—É—Ä—Å–æ–≤–æ–π —Ä–∞–±–æ—Ç—ã –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –∏–∑ —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã Big Data –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á.

![alt text](image.png)
![alt text](image-1.png)

## üöÄ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

*   **–ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:** –î–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è "–Ω–∞ –ª–µ—Ç—É" –ø–æ –º–µ—Ä–µ –∏—Ö –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –±–ª–∞–≥–æ–¥–∞—Ä—è —Å–≤—è–∑–∫–µ Kafka –∏ Spark Structured Streaming.
*   **–û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:** –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–æ–≥–∞—â–∞–µ—Ç –ª–æ–≥–∏ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –æ–ø—Ä–µ–¥–µ–ª—è—è —Å—Ç—Ä–∞–Ω—É –ø–æ IP-–∞–¥—Ä–µ—Å—É.
*   **–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ:** –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –¥–µ—Ç–µ–∫—Ü–∏–∏ –∞–Ω–æ–º–∞–ª–∏–π –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, DDoS-–∞—Ç–∞–∫).
*   **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –¥–∞—à–±–æ—Ä–¥:** –ü–∞–Ω–µ–ª—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–∞ Streamlit —Å KPI, –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏, –≥–µ–æ-–∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π –Ω–∞ –∫–∞—Ä—Ç–µ –º–∏—Ä–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏.
*   **Ad-hoc –ê–Ω–∞–ª–∏—Ç–∏–∫–∞:** –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –æ—Ç—á–µ—Ç–æ–≤, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –¥–∞–Ω–Ω—ã–º –±–µ–∑ –∑–Ω–∞–Ω–∏—è SQL.
*   **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å:** –ü–∞–π–ø–ª–∞–π–Ω —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ "–≥—Ä—è–∑–Ω—ã—Ö" –¥–∞–Ω–Ω—ã—Ö, –æ–Ω –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏.
*   **–ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è:** –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ—Ç—É —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π.

## ‚öôÔ∏è –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è                       | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è                                     |
| ------------------------------- | ---------------------------------------------- |
| **–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö**                 | Nginx, Filebeat                                |
| **–ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π**            | Apache Kafka                                   |
| **–ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ ML**    | Apache Spark (PySpark)                         |
| **–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**   | ClickHouse                                     |
| **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –¥–∞—à–±–æ—Ä–¥**      | Streamlit                                      |
| **–û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è**                 | Docker, Docker Compose                         |
| **–û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**           | GeoLite2 –æ—Ç MaxMind                            |

## üèõÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –ø–æ—Ç–æ–∫–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö:

1.  **Nginx** –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `access.log` –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—É.
2.  **Filebeat** –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ª–æ–≥-—Ñ–∞–π–ª–µ –∏ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤ —Ç–æ–ø–∏–∫ Kafka.
3.  **Apache Kafka** –≤—ã—Å—Ç—É–ø–∞–µ—Ç –≤ —Ä–æ–ª–∏ –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ –±—É—Ñ–µ—Ä–∞ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π.
4.  **PySpark** –≤ —Ä–µ–∂–∏–º–µ `Structured Streaming` —á–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ Kafka, –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä–æ–∫, –æ–±–æ–≥–∞—â–∞–µ—Ç –∏—Ö –≥–µ–æ–ª–æ–∫–∞—Ü–∏–µ–π, –ø—Ä–∏–º–µ–Ω—è–µ—Ç –ª–æ–≥–∏–∫—É –¥–µ—Ç–µ–∫—Ü–∏–∏ –∞–Ω–æ–º–∞–ª–∏–π –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ ClickHouse.
5.  **ClickHouse** —Ö—Ä–∞–Ω–∏—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —Å–≤–µ—Ä—Ö–±—ã—Å—Ç—Ä—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã.
6.  **Streamlit** –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ ClickHouse –∏ —Å—Ç—Ä–æ–∏—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –¥–∞—à–±–æ—Ä–¥ –¥–ª—è –∫–æ–Ω–µ—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

*   [Docker](https://www.docker.com/get-started) –∏ [Docker Compose](https://docs.docker.com/compose/install/) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ –≤–∞—à–µ–π –º–∞—à–∏–Ω–µ.
*   Python 3.9+ (–¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–æ–≤).
*   –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ `Faker`: `pip install Faker`

### –®–∞–≥ 1: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –±–∞–∑—ã –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏

–î–ª—è –æ–±–æ–≥–∞—â–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ IP –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –±–∞–∑–∞ GeoLite2.

1.  –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [—Å–∞–π—Ç–µ MaxMind](https://www.maxmind.com/en/geolite2/signup) –∏ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç.
2.  –í –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "Download Files" –∏ —Å–∫–∞—á–∞–π—Ç–µ –±–∞–∑—É **"GeoLite2 Country"** –≤ —Ñ–æ—Ä–º–∞—Ç–µ `.mmdb`.
3.  –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ —Å–∫–∞—á–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –≤ `GeoLite2-Country.mmdb`.
4.  **–ü–æ–º–µ—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –≤ –ø–∞–ø–∫—É `spark/` –ø—Ä–æ–µ–∫—Ç–∞.** –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–π —à–∞–≥.

### –®–∞–≥ 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –ª–æ–≥-—Ñ–∞–π–ª. –°–∫—Ä–∏–ø—Ç `generate_logs.py` —Å–æ–∑–¥–∞—Å—Ç 10,000 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤, –≤–∫–ª—é—á–∞—è —Å–∏–º—É–ª—è—Ü–∏—é –Ω–µ–±–æ–ª—å—à–æ–π DDoS-–∞—Ç–∞–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞ –∞–Ω–æ–º–∞–ª–∏–π.

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞:
```bash
python generate_logs.py
```
–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª `access.log` –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `nginx/logs/`.

### –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞.

```bash
docker-compose up --build -d
```
*   `--build`: –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç –æ–±—Ä–∞–∑—ã, –µ—Å–ª–∏ –≤ –Ω–∏—Ö –±—ã–ª–∏ –≤–Ω–µ—Å–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è (–≤–∞–∂–Ω–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ).
*   `-d`: –ó–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ.

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞:
*   **–î–∞—à–±–æ—Ä–¥** –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: [http://localhost:8501](http://localhost:8501)
*   **Nginx** (–∏—Å—Ç–æ—á–Ω–∏–∫ –ª–æ–≥–æ–≤) –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: [http://localhost:8080](http://localhost:8080)

**–í–Ω–∏–º–∞–Ω–∏–µ:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–æ–≥–æ–≤ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç. –í—ã –º–æ–∂–µ—Ç–µ –Ω–∞–±–ª—é–¥–∞—Ç—å –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º –≤ –ª–æ–≥–∞—Ö Spark:
```bash
docker-compose logs -f spark
```
–ö–∞–∫ —Ç–æ–ª—å–∫–æ –≤ –ª–æ–≥–∞—Ö –ø–æ—è–≤—è—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è "Batch X –∑–∞–ø–∏—Å–∞–Ω –≤ ClickHouse", –¥–∞–Ω–Ω—ã–µ –Ω–∞—á–Ω—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –Ω–∞ –¥–∞—à–±–æ—Ä–¥–µ.

### ‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

–î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
docker-compose down
```
–î–ª—è **–ø–æ–ª–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏** (–≤–∫–ª—é—á–∞—è –≤—Å–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ ClickHouse –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è Kafka), –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–ª–∞–≥ `-v`:
```bash
docker-compose down -v
```